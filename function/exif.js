function _0x27bd(_0x4d193a,_0x1d22ea){_0x4d193a=_0x4d193a-0x97;const _0x4a4604=_0x4a46();let _0x27bd8c=_0x4a4604[_0x4d193a];return _0x27bd8c;}(function(_0x3708b2,_0x2af3ca){const _0x40debd=_0x3708b2();while(!![]){try{const _0x3206da=parseInt(_0x27bd(0x99))/0x1*(-parseInt(_0x27bd(0x9b))/0x2)+parseInt(_0x27bd(0xae))/0x3+-parseInt(_0x27bd(0xa8))/0x4*(parseInt(_0x27bd(0xb8))/0x5)+parseInt(_0x27bd(0x9c))/0x6+-parseInt(_0x27bd(0xa4))/0x7*(parseInt(_0x27bd(0xac))/0x8)+-parseInt(_0x27bd(0xa5))/0x9+-parseInt(_0x27bd(0xa3))/0xa*(-parseInt(_0x27bd(0x98))/0xb);if(_0x3206da===_0x2af3ca)break;else _0x40debd['push'](_0x40debd['shift']());}catch(_0x4675a0){_0x40debd['push'](_0x40debd['shift']());}}}(_0x4a46,0x917b2));import{writeFileSync,readFileSync,unlinkSync}from'fs';import{tmpdir}from'os';import{randomBytes}from'crypto';import _0x4a5a08 from'fluent-ffmpeg';import _0x247420 from'node-webpmux';const {Image}=_0x247420;function _0x4a46(){const _0x8b00ff=['exif','.jpg','-vf','webp','.mp4','utf-8','-preset','writeUIntLE','35RuDEQK','https://github.com/XM4ZE','dirname','error','readUIntLE','-vsync','.webp','libwebp','10257929KQPrlk','361Ldsuvx','load','4726PDmoOH','4970370slKeeU','toString','author','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','packname','length','categories','30hjYfKf','68124mKSgtG','4398300srfHjG','stringify','-vcodec','469844LuSQWG','00:00:06','toFormat','save','872hUffcz','from','583908OfBthj','-loop'];_0x4a46=function(){return _0x8b00ff;};return _0x4a46();}import _0x1a49e4 from'path';import{join}from'path';import{fileURLToPath}from'url';const __dirname=_0x1a49e4[_0x27bd(0xba)](fileURLToPath(import.meta.url));async function imageToWebp(_0x32679b){const _0x4b82a2=join(tmpdir(),randomBytes(0x6)['readUIntLE'](0x0,0x6)[_0x27bd(0x9d)](0x24)+'.webp'),_0x5a5af0=join(tmpdir(),randomBytes(0x6)[_0x27bd(0xbc)](0x0,0x6)['toString'](0x24)+_0x27bd(0xb1));writeFileSync(_0x5a5af0,_0x32679b),await new Promise((_0xbb20e3,_0x2656b7)=>{_0x4a5a08(_0x5a5af0)['on']('error',_0x2656b7)['on']('end',()=>_0xbb20e3(!![]))['addOutputOptions'](['-vcodec','libwebp',_0x27bd(0xb2),_0x27bd(0x9f)])[_0x27bd(0xaa)](_0x27bd(0xb3))['save'](_0x4b82a2);});const _0x2b3ea7=readFileSync(_0x4b82a2);return unlinkSync(_0x4b82a2),unlinkSync(_0x5a5af0),_0x2b3ea7;}async function videoToWebp(_0x4e48e6){const _0x2e0814=join(tmpdir(),randomBytes(0x6)['readUIntLE'](0x0,0x6)[_0x27bd(0x9d)](0x24)+'.webp'),_0x18ddfb=join(tmpdir(),randomBytes(0x6)[_0x27bd(0xbc)](0x0,0x6)[_0x27bd(0x9d)](0x24)+_0x27bd(0xb4));writeFileSync(_0x18ddfb,_0x4e48e6),await new Promise((_0x281bd4,_0x5dce59)=>{_0x4a5a08(_0x18ddfb)['on'](_0x27bd(0xbb),_0x5dce59)['on']('end',()=>_0x281bd4(!![]))['addOutputOptions']([_0x27bd(0xa7),_0x27bd(0x97),_0x27bd(0xb2),'scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse',_0x27bd(0xaf),'0','-ss','00:00:00','-t',_0x27bd(0xa9),_0x27bd(0xb6),'default','-an',_0x27bd(0xbd),'0'])['toFormat']('webp')['save'](_0x2e0814);});const _0x5e10e6=readFileSync(_0x2e0814);return unlinkSync(_0x2e0814),unlinkSync(_0x18ddfb),_0x5e10e6;}async function writeExifImg(_0x4970fd,_0x298dee){let _0x28f5ed=await imageToWebp(_0x4970fd);const _0x388e2a=join(tmpdir(),randomBytes(0x6)['readUIntLE'](0x0,0x6)['toString'](0x24)+_0x27bd(0xbe)),_0x19dc56=join(tmpdir(),randomBytes(0x6)[_0x27bd(0xbc)](0x0,0x6)[_0x27bd(0x9d)](0x24)+_0x27bd(0xbe));writeFileSync(_0x388e2a,_0x28f5ed);if(_0x298dee['packname']||_0x298dee['author']){const _0x1d08ef=new Image(),_0xbc433b={'sticker-pack-id':'https://github.com/XM4ZE','sticker-pack-name':_0x298dee['packname'],'sticker-pack-publisher':_0x298dee['author'],'emojis':_0x298dee['categories']?_0x298dee['categories']:['']},_0x4c54fd=Buffer[_0x27bd(0xad)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x28ea47=Buffer[_0x27bd(0xad)](JSON[_0x27bd(0xa6)](_0xbc433b),_0x27bd(0xb5)),_0x16e008=Buffer['concat']([_0x4c54fd,_0x28ea47]);return _0x16e008['writeUIntLE'](_0x28ea47[_0x27bd(0xa1)],0xe,0x4),await _0x1d08ef[_0x27bd(0x9a)](_0x388e2a),unlinkSync(_0x388e2a),_0x1d08ef['exif']=_0x16e008,await _0x1d08ef[_0x27bd(0xab)](_0x19dc56),_0x19dc56;}}async function writeExifVid(_0x331077,_0x57350d){let _0x4d836a=await videoToWebp(_0x331077);const _0x146ba3=join(tmpdir(),randomBytes(0x6)[_0x27bd(0xbc)](0x0,0x6)[_0x27bd(0x9d)](0x24)+'.webp'),_0x49b094=join(tmpdir(),randomBytes(0x6)[_0x27bd(0xbc)](0x0,0x6)['toString'](0x24)+_0x27bd(0xbe));writeFileSync(_0x146ba3,_0x4d836a);if(_0x57350d[_0x27bd(0xa0)]||_0x57350d[_0x27bd(0x9e)]){const _0x78431c=new Image(),_0x49f04f={'sticker-pack-id':_0x27bd(0xb9),'sticker-pack-name':_0x57350d[_0x27bd(0xa0)],'sticker-pack-publisher':_0x57350d['author'],'emojis':_0x57350d[_0x27bd(0xa2)]?_0x57350d[_0x27bd(0xa2)]:['']},_0x2dea00=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x4e53e2=Buffer['from'](JSON['stringify'](_0x49f04f),'utf-8'),_0x19f8c6=Buffer['concat']([_0x2dea00,_0x4e53e2]);return _0x19f8c6[_0x27bd(0xb7)](_0x4e53e2['length'],0xe,0x4),await _0x78431c[_0x27bd(0x9a)](_0x146ba3),unlinkSync(_0x146ba3),_0x78431c[_0x27bd(0xb0)]=_0x19f8c6,await _0x78431c[_0x27bd(0xab)](_0x49b094),_0x49b094;}}export{imageToWebp,videoToWebp,writeExifImg,writeExifVid};